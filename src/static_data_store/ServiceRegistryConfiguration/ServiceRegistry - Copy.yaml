codeGen:

  generatedCodePath: C:/Users/JackM/source/repos/Weather App/ServiceRegistry/ServiceRegistry
#  externalOverridesFile: C:/Temp/MetworksWeatherOverrides/overrides.yaml
  resourceProvider: StaticDataStore
  targetNamespace: ServiceRegistry
  enumTemplatePath: CodeGeneration/NamedInstanceAccessor/Templates/Enums.tplt
  enums:
    - enum: RegAssembly
      scope: internal
    - enum: RegInterface
      scope: internal
    - enum: RegType
      scope: internal
    - enum: RegNamedInstance
      scope: public
    
  namedInstanceAccessor:  
    class: NamedInstanceAccessor
    namedInstanceAccessorClassTemplatePath: CodeGeneration/NamedInstanceAccessor/Templates/NamedInstanceAccessorClass.tplt
    namedInstanceAccessorFunctionTemplatePath: CodeGeneration/NamedInstanceAccessor/Templates/NamedInstanceAccessorFunction.tplt
  
namespace: ServiceRegistry
registryClass: Registry

assemblies:
  - assembly: InterfaceDefinition
    fullName: InterfaceDefinition, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
    path: C:/Users/JackM/source/repos/Weather App/ServiceAssemblies/InterfaceDefinition.dll
  - assembly: Logging
    fullName: Logging, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
    path: C:/Users/JackM/source/repos/Weather App/ServiceAssemblies/Logging.dll
  - assembly: Settings
    fullName: Settings, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
    path: C:/Users/JackM/source/repos/Weather App/ServiceAssemblies/Settings.dll
  - assembly: System
    primitive: true
  - assembly: Utility
    fullName: Utility, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
    path: C:/Users/JackM/source/repos/Weather App/ServiceAssemblies/Utility.dll
  - assembly: Resources
    fullName: Resources, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
    path: C:/Users/JackM/source/repos/Weather App/ServiceAssemblies/Resources.dll
  - assembly: UdpInRawPacketRecordTypedOut
    fullName: UdpInRawPacketRecordTypedOut, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
    path: C:/Users/JackM/source/repos/Weather App/ServiceAssemblies/UdpInRawPacketRecordTypedOut.dll
  - assembly: RawPacketRecordTypedInPostgresOut
    fullName: RawPacketRecordTypedInPostgresOut, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null
    path: C:/Users/JackM/source/repos/Weather App/ServiceAssemblies/RawPacketRecordTypedInPostgresOut.dll
  
namespaces:

  - namespace: InterfaceDefinition
  
    interfaces:
    
      - interface: IFileLogger
        assemblyKey: InterfaceDefinition      
        
      - interface: ISettingsRepository
        assemblyKey: InterfaceDefinition
        
      - interface: IBackgroundService
        assemblyKey: InterfaceDefinition
        
  - namespace: System
  
    types:
    
      - type: String
        assemblyKey: System

      - type: String[]
        assemblyKey: System

      - type: Int32
        assemblyKey: System

      - type: Boolean
        assemblyKey: System

      - type: CancellationTokenSource
        assemblyKey: System
        assignable: false
  
  - namespace: Logging
  
    types:
    
      - type: FileLogger
        assemblyKey: Logging
        interfaceKeys:
          - InterfaceDefinition.IFileLogger
        initializers:
          - initializer: InitializeAsync
            parameters:
              requireds:
                - parameter: fileSizeLimitBytes
                  typeKey: System.Int32
                - parameter: minimumLevel
                  typeKey: System.String
                - parameter: outputTemplate
                  typeKey: System.String
                - parameter: path
                  typeKey: System.String
                - parameter: retainedFileCountLimit
                  typeKey: System.Int32
                - parameter: rollingInterval
                  typeKey: System.String
                - parameter: rollOnFileSizeLimit
                  typeKey: System.Boolean
              optionals:
                - parameter: fakeOptionalParameter
                  typeKey: System.String

  - namespace: Settings
  
    types:

      - type: SettingConfiguration
        assemblyKey: Settings
        initializers:
          - initializer: InitializeAsync
            parameters:
              requireds:
                - parameter: defaultValue
                  typeKey: System.String
                - parameter: description
                  typeKey: System.String
                - parameter: expectedValueType
                  typeKey: System.String
                - parameter: group
                  typeKey: System.String
                - parameter: isEditable
                  typeKey: System.Boolean
                - parameter: path
                  typeKey: System.String

              optionals:
                - parameter: enumValues
                  typeKey: System.String[]
                - parameter: isSecret
                  typeKey: System.Boolean

      - type: SettingConfiguration[]
        assemblyKey: Settings

        # ToDo: Change design to use a Single Repository and ensure paths are unique
        # As of 2025/10/27 there is a non-thread safe single dictionary pointed to by
        # Multiple SettingsRepsitories, which is not safe or ideal.
      - type: SettingsRepository
        assemblyKey: Settings
        initializers:
          - initializer: InitializeAsync
            parameters:
              requireds:
                - parameter: iFileLogger
                  typeKey: Logging.FileLogger
                  interfaceKey: InterfaceDefinition.IFileLogger
                - parameter: settingConfigurations
                  typeKey: Settings.SettingConfiguration[]

  - namespace: UdpInRawPacketRecordTypedOut 
    
    types:

      - type: Transformer
        assemblyKey: UdpInRawPacketRecordTypedOut
        interfaceKeys:
          - InterfaceDefinition.IBackgroundService
        initializers:
          - initializer: InitializeAsync
            parameters:
              requireds:
                - parameter: iFileLogger
                  typeKey: Logging.FileLogger
                  interfaceKey: InterfaceDefinition.IFileLogger
                - parameter: iSettingsRepository
                  typeKey: Settings.SettingsRepository
                  interfaceKey: InterfaceDefinition.ISettingsRepository
                - parameter: externalCancellationTokenSource
                  typeKey: System.CancellationTokenSource

  - namespace: RawPacketRecordTypedInPostgresOut
  
    types:

      - type: ListenerSink
        assemblyKey: RawPacketRecordTypedInPostgresOut
        interfaceKeys:
          - InterfaceDefinition.IBackgroundService
        initializers:
          - initializer: InitializeAsync
            parameters:
              requireds:
                - parameter: iFileLogger
                  typeKey: Logging.FileLogger
                  interfaceKey: InterfaceDefinition.IFileLogger
                - parameter: iSettingsRepository
                  typeKey: Settings.SettingsRepository
                  interfaceKey: InterfaceDefinition.ISettingsRepository

namedInstances:

  - namedInstance: RootCancellationTokenSource
    typeKey: System.CancellationTokenSource

  - namedInstance: TheFileLogger
    typeKey: Logging.FileLogger
    exposeAsInterface: InterfaceDefinition.IFileLogger
    initializerKey: InitializeAsync
    assignments:
      requireds:
        - parameter: fileSizeLimitBytes
          value: 10485760
        - parameter: minimumLevel
          value: Information
        - parameter: outputTemplate
          value: "[{Timestamp:yyyy-MM-dd HH:mm:ss} {Level:u3}] {Message:lj}{NewLine}{Exception}"
        - parameter: path
          value: logs/log-.txt
        - parameter: retainedFileCountLimit
          value: 7
        - parameter: rollingInterval
          value: Day
        - parameter: rollOnFileSizeLimit
          value: true
      optionals:
        - parameter: fakeOptionalParameter
          value: testOptionalParameterValue

  - namedInstance: TheUdpPortSetting
    typeKey: Settings.SettingConfiguration
    initializerKey: InitializeAsync
    assignments:
      requireds:
        - parameter: defaultValue
          value: 50222
        - parameter: description
          value: UDP Port for listening for readings from Tempest Weather Station
        - parameter: expectedValueType
          value: Int32
        - parameter: group
          value: UDPSettings
        - parameter: isEditable
          value: true
        - parameter: path
          value: /services/UDPSettings/PreferredPort

  - namedInstance: TheUdpPortSettings
    typeKey: Settings.SettingConfiguration[]
    elements:
      - namedInstanceKey: TheUdpPortSetting

  - namedInstance: TemperatureOptions
    typeKey: System.String[]
    elements:
      - value: degree celsius
      - value: degree fahrenheit

  - namedInstance: UdpTemperatureSetting
    typeKey: Settings.SettingConfiguration
    initializerKey: InitializeAsync
    assignments:
      requireds:
        - parameter: defaultValue
          value: degree fahrenheit
        - parameter: description
          value: Override temperature unit for UDP readings
        - parameter: expectedValueType
          value: String
        - parameter: group
          value: units
        - parameter: isEditable
          value: true
        - parameter: path
          value: /services/udp/unitOverrides/temperature
      optionals:
        - parameter: enumValues
          namedInstanceKey: TemperatureOptions

  - namedInstance: WindspeedOptions
    typeKey: System.String[]
    elements:
      - value: kilometer/hour
      - value: knot
      - value: meter/second
      - value: mile/hour

  - namedInstance: UdpWindspeedSetting
    typeKey: Settings.SettingConfiguration
    initializerKey: InitializeAsync
    assignments:
      requireds:
        - parameter: defaultValue
          value: mile/hour
        - parameter: description
          value: Override wind speed unit for UDP readings
        - parameter: expectedValueType
          value: String
        - parameter: group
          value: units
        - parameter: isEditable
          value: true
        - parameter: path
          value: /services/udp/unitOverrides/windSpeed
      optionals:
        - parameter: enumValues
          namedInstanceKey: WindspeedOptions

  - namedInstance: PressureOptions
    typeKey: System.String[]
    elements:
      - value: atmosphere
      - value: bar
      - value: hectopascal
      - value: inch of mercury
      - value: kilopascal
      - value: millibar
      - value: pascal

  - namedInstance: UdpPressureSetting
    typeKey: Settings.SettingConfiguration
    initializerKey: InitializeAsync
    assignments:
      requireds:
        - parameter: defaultValue
          value: millibar
        - parameter: description
          value: Override pressure unit for UDP readings
        - parameter: expectedValueType
          value: String
        - parameter: group
          value: units
        - parameter: isEditable
          value: true
        - parameter: path
          value: /services/udp/unitOverrides/pressure
      optionals:
        - parameter: enumValues
          namedInstanceKey: PressureOptions

  - namedInstance: PrecipitationOptions
    typeKey: System.String[]
    elements:
      - value: centimeter
      - value: inch
      - value: millimeter

  - namedInstance: UdpPrecipitationSetting
    typeKey: Settings.SettingConfiguration
    initializerKey: InitializeAsync
    assignments:
      requireds:
        - parameter: defaultValue
          value: inch
        - parameter: description
          value: Override precipitation unit for UDP readings
        - parameter: expectedValueType
          value: String
        - parameter: group
          value: units
        - parameter: isEditable
          value: true
        - parameter: path
          value: /services/udp/unitOverrides/precipitation
      optionals:
        - parameter: enumValues
          namedInstanceKey: PrecipitationOptions

  - namedInstance: DistanceOptions
    typeKey: System.String[]
    elements:
      - value: kilometer
      - value: meter
      - value: mile
      - value: nautical mile

  - namedInstance: UdpDistanceSetting
    typeKey: Settings.SettingConfiguration
    initializerKey: InitializeAsync
    assignments:
      requireds:
        - parameter: defaultValue
          value: mile
        - parameter: description
          value: Override distance unit for UDP readings
        - parameter: expectedValueType
          value: String
        - parameter: group
          value: units
        - parameter: isEditable
          value: true
        - parameter: path
          value: /services/udp/unitOverrides/distance
      optionals:
        - parameter: enumValues
          namedInstanceKey: DistanceOptions

  - namedInstance: TheUdpListenerSettings
    typeKey: Settings.SettingConfiguration[]
    elements:
      - namedInstanceKey: UdpTemperatureSetting
      - namedInstanceKey: UdpWindspeedSetting
      - namedInstanceKey: UdpPressureSetting
      - namedInstanceKey: UdpPrecipitationSetting
      - namedInstanceKey: UdpDistanceSetting

  - namedInstance: TheUDPSettingsRepository
    typeKey: Settings.SettingsRepository
    initializerKey: InitializeAsync
    assignments:
      requireds:
        - parameter: iFileLogger
          namedInstanceKey: TheFileLogger
        - parameter: settingConfigurations
          namedInstanceKey: TheUdpPortSettings

  - namedInstance: TheUdpListener
    typeKey: UdpInRawPacketRecordTypedOut.Transformer
    initializerKey: InitializeAsync
    exposeAsInterface: InterfaceDefinition.IBackgroundService
    eagerLoad: true
    assignments:
      requireds:
        - parameter: iFileLogger
          namedInstanceKey: TheFileLogger
        - parameter: iSettingsRepository
          namedInstanceKey: TheUDPSettingsRepository
        - parameter: externalCancellationTokenSource
          namedInstanceKey: RootCancellationTokenSource

  - namedInstance: ThePostgresConnection
    typeKey: Settings.SettingConfiguration
    initializerKey: InitializeAsync
    assignments:
      requireds:
        - parameter: defaultValue
          value: emptyString
        - parameter: description
          value: Connection string for save weather data to Postgres
        - parameter: expectedValueType
          value: String
        - parameter: group
          value: database
        - parameter: isEditable
          value: true
        - parameter: path
          value: /services/RawPacketRecordTypedInPostgresOut/connectionString
      optionals:
        - parameter: isSecret
          value: true

  - namedInstance: ThePostgresSettings
    typeKey: Settings.SettingConfiguration[]
    elements:
      - namedInstanceKey: ThePostgresConnection

  - namedInstance: ThePostgresSettingsRepository
    typeKey: Settings.SettingsRepository
    initializerKey: InitializeAsync
    assignments:
      requireds:
        - parameter: iFileLogger
          namedInstanceKey: TheFileLogger
        - parameter: settingConfigurations
          namedInstanceKey: ThePostgresSettings

  - namedInstance: TheRawPacketRecordTypedInPostgresOut
    typeKey: RawPacketRecordTypedInPostgresOut.ListenerSink
    initializerKey: InitializeAsync
    exposeAsInterface: InterfaceDefinition.IBackgroundService
    assignments:
      requireds:
        - parameter: iFileLogger
          namedInstanceKey: TheFileLogger
        - parameter: iSettingsRepository
          namedInstanceKey: ThePostgresSettingsRepository